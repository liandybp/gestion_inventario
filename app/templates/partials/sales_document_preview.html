<div class="card mt-12">
  <div class="flex justify-between gap-12 items-center flex-wrap">
    <h4 class="m-0">Vista previa</h4>
    <button type="button" class="btn-secondary" data-clear-target="#sales-doc-preview">Cerrar</button>
  </div>

  <div class="grid grid-2 mt-10">
    <div>
      <div><strong>Tipo:</strong> {{ doc_label }}</div>
      <div><strong>Cliente:</strong> {{ client_name }} ({{ client_id }})</div>
      {% if client_address %}<div><strong>Dirección:</strong> {{ client_address }}</div>{% endif %}
      {% if notes %}<div><strong>Notas:</strong> {{ notes }}</div>{% endif %}
    </div>
    <div class="text-right">
      <div><strong>Subtotal:</strong> {{ currency_symbol }}{{ '%.2f'|format(subtotal) }}</div>
      <div><strong>Total:</strong> {{ currency_symbol }}{{ '%.2f'|format(total) }}</div>
      <div class="muted">(Precios sin IVA)</div>
    </div>
  </div>

  <table class="mt-10">
    <thead>
      <tr>
        <th>#</th>
        <th>Descripción</th>
        <th class="text-right">Cant.</th>
        <th class="text-right">Precio</th>
        <th class="text-right">Total</th>
      </tr>
    </thead>
    <tbody>
      {% for it in items %}
        <tr>
          <td>{{ loop.index }}</td>
          <td>{{ it.description }}</td>
          <td class="text-right">{{ '%.2f'|format(it.quantity) }}</td>
          <td class="text-right">{{ currency_symbol }}{{ '%.2f'|format(it.unit_price) }}</td>
          <td class="text-right">{{ currency_symbol }}{{ '%.2f'|format(it.line_total) }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <form hx-post="/ui/sales-doc/issue" hx-target="#sales-doc-panel" hx-swap="outerHTML" class="mt-12">
    <input type="hidden" name="doc_type" value="{{ doc_type }}" />
    <input type="hidden" name="location_code" value="{{ location_code or '' }}" />
    <input type="hidden" name="client_name" value="{{ client_name }}" />
    <input type="hidden" name="client_id" value="{{ client_id }}" />
    <input type="hidden" name="client_address" value="{{ client_address or '' }}" />
    <input type="hidden" name="notes" value="{{ notes or '' }}" />
    <button type="submit">Emitir ahora</button>
  </form>
</div>
