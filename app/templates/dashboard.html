<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Inventario</title>
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
    <link rel="stylesheet" href="/static/css/app.css?v=32" />
    <script src="/static/js/app.js?v=32" defer></script>
  </head>
  <body>
    <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Abrir menú">
      ☰
    </button>
    <div class="mobile-menu-overlay" id="mobile-menu-overlay"></div>
    
    <div class="app-layout">
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <h2>Dashboard</h2>
          {% if user %}
            <div class="sidebar-user">{{ user.username }} ({{ user.role }})</div>
            <a href="/ui/logout" class="sidebar-logout">Cerrar sesión</a>
          {% endif %}
        </div>
        
        <nav class="sidebar-nav" role="navigation" aria-label="Secciones">
          {% if not user or (user.role or '')|lower != 'operator' %}
          <button class="sidebar-item" id="tab-home" aria-selected="true"
                  hx-get="/ui/tabs/home" hx-target="#tab-content" hx-swap="innerHTML">
            Inicio
          </button>
          <button class="sidebar-item" id="tab-inventory" aria-selected="false"
                  hx-get="/ui/tabs/inventory" hx-target="#tab-content" hx-swap="innerHTML">
            Inventario
          </button>
          {% if user and (user.role or '')|lower == 'admin' %}
          <button class="sidebar-item" id="tab-purchases" aria-selected="false"
                  hx-get="/ui/tabs/purchases" hx-target="#tab-content" hx-swap="innerHTML">
            Compras
          </button>
          {% endif %}

          <button class="sidebar-item" id="tab-transfers" aria-selected="false"
                  hx-get="/ui/tabs/transfers" hx-target="#tab-content" hx-swap="innerHTML">
            Traspasos
          </button>
          {% endif %}

          <button class="sidebar-item" id="tab-sales" aria-selected="{% if user and (user.role or '')|lower == 'operator' %}true{% else %}false{% endif %}"
                  hx-get="/ui/tabs/sales" hx-target="#tab-content" hx-swap="innerHTML">
            Ventas
          </button>

          <button class="sidebar-item" id="tab-documents" aria-selected="false"
                  hx-get="/ui/tabs/documents" hx-target="#tab-content" hx-swap="innerHTML">
            Documentos
          </button>

          <button class="sidebar-item" id="tab-customers" aria-selected="false"
                  hx-get="/ui/tabs/customers" hx-target="#tab-content" hx-swap="innerHTML">
            Clientes
          </button>

          <button class="sidebar-item" id="tab-expenses" aria-selected="false"
                  hx-get="/ui/tabs/expenses" hx-target="#tab-content" hx-swap="innerHTML">
            Costos operativos
          </button>

          {% if not user or (user.role or '')|lower != 'operator' %}
          <button class="sidebar-item" id="tab-profit-items" aria-selected="false"
                  hx-get="/ui/tabs/profit-items" hx-target="#tab-content" hx-swap="innerHTML">
            Utilidades por artículo
          </button>

          <button class="sidebar-item" id="tab-profit" aria-selected="false"
                  hx-get="/ui/tabs/profit" hx-target="#tab-content" hx-swap="innerHTML">
            Utilidades
          </button>

          <button class="sidebar-item" id="tab-dividends" aria-selected="false"
                  hx-get="/ui/tabs/dividends" hx-target="#tab-content" hx-swap="innerHTML">
            Dividendos
          </button>

          <button class="sidebar-item" id="tab-history" aria-selected="false"
                  hx-get="/ui/tabs/history" hx-target="#tab-content" hx-swap="innerHTML">
            Historial
          </button>

          {% if user and (user.role or '')|lower == 'admin' %}
          <button class="sidebar-item" id="tab-activity" aria-selected="false"
                  hx-get="/ui/tabs/activity" hx-target="#tab-content" hx-swap="innerHTML">
            Actividad
          </button>
          {% endif %}
          {% endif %}
        </nav>
      </aside>

      <main class="main-content">
        <div id="tab-content"
             hx-get="{% if user and (user.role or '')|lower == 'operator' %}/ui/tabs/sales{% else %}/ui/tabs/home{% endif %}" hx-trigger="load" hx-swap="innerHTML">
        </div>
      </main>
    </div>
    
    <div id="modal-container"></div>
  </body>
</html>
