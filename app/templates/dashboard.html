<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Inventario</title>
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
    <link rel="stylesheet" href="/static/css/app.css" />
    <script src="/static/js/app.js" defer></script>
  </head>
  <body>
    <div style="display:flex; align-items:flex-end; justify-content:space-between; gap:12px; margin-bottom:6px;">
      <h1 style="margin:0;">Dashboard</h1>
      <div class="muted" style="display:flex; gap:10px; align-items:center;">
        {% if user %}
          <span>{{ user.username }} ({{ user.role }})</span>
          <a href="/ui/logout">Cerrar sesión</a>
        {% endif %}
      </div>
    </div>
    <p class="muted">La tabla se actualiza automáticamente. Si un SKU baja de stock mínimo, se marca.</p>

    <div class="tabs" role="tablist" aria-label="Secciones">
      {% if not user or (user.role or '')|lower != 'operator' %}
      <button class="tab" id="tab-home" aria-selected="true"
              hx-get="/ui/tabs/home" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Inicio
      </button>
      <button class="tab" id="tab-inventory" aria-selected="false"
              hx-get="/ui/tabs/inventory" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Inventario
      </button>
      {% if user and (user.role or '')|lower == 'admin' %}
      <button class="tab" id="tab-purchases" aria-selected="false"
              hx-get="/ui/tabs/purchases" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Compras
      </button>
      {% endif %}
      {% endif %}

      <button class="tab" id="tab-sales" aria-selected="{% if user and (user.role or '')|lower == 'operator' %}true{% else %}false{% endif %}"
              hx-get="/ui/tabs/sales" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Ventas
      </button>

      <button class="tab" id="tab-documents" aria-selected="false"
              hx-get="/ui/tabs/documents" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Documentos
      </button>

      <button class="tab" id="tab-customers" aria-selected="false"
              hx-get="/ui/tabs/customers" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Clientes
      </button>

      <button class="tab" id="tab-expenses" aria-selected="false"
              hx-get="/ui/tabs/expenses" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Costos operativos
      </button>

      {% if not user or (user.role or '')|lower != 'operator' %}
      <button class="tab" id="tab-profit-items" aria-selected="false"
              hx-get="/ui/tabs/profit-items" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Utilidades por artículo
      </button>

      <button class="tab" id="tab-profit" aria-selected="false"
              hx-get="/ui/tabs/profit" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Utilidades
      </button>

      <button class="tab" id="tab-dividends" aria-selected="false"
              hx-get="/ui/tabs/dividends" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Dividendos
      </button>

      <button class="tab" id="tab-history" aria-selected="false"
              hx-get="/ui/tabs/history" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Historial
      </button>

      {% if user and (user.role or '')|lower == 'admin' %}
      <button class="tab" id="tab-activity" aria-selected="false"
              hx-get="/ui/tabs/activity" hx-target="#tab-content" hx-swap="innerHTML"
              >
        Actividad
      </button>
      {% endif %}
      {% endif %}

    </div>

    <div id="tab-content" class="card"
         hx-get="{% if user and (user.role or '')|lower == 'operator' %}/ui/tabs/sales{% else %}/ui/tabs/home{% endif %}" hx-trigger="load" hx-swap="innerHTML">
    </div>
  </body>
</html>
